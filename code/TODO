TODO:
- implement early stopping # done
- visualize the loss curve # done
- maby cross-validation 20% set size # done
    - do metrics also for cv sets # done
- evaluate on per protein basis instead of whole set        !!!!!!! doable
- mcc on whole set
- accuracy average on per protein level
- hyperparameter optimization (optimize by mcc)
    - optimize contact map
    - layer size, amout of layers, decreasing size layers, stagnating size layers # done
    - batch normalization, dropout
    - bias and hops: bias=False, k=2
    - pooling to decrease feature space
    - also look up in the dgl what else to optimize
- different embeddings
    - write fasta to send to michael # in work
    - parse fasta into dictionary to receive in the embeddings function of HZ_full # in work
- visualization of results
- try out different machine learning models
- write evaluation of a model
- create script to turn normal pdb file into the


{
0: [0.08810151519903515, 0.09299373027416875, 0.08483697524708889, 0.09037581487986611, 0.09597154247486579, 0.11715455347115374, 0.11153903272312739, 0.11842815618893136, 0.1093738140347444, 0.12357822744619419, 0.09080933806368587, 0.07768108600614976, 0.07690509238771477, 0.08045536163249753, 0.08710069876124296, 0.08913991269266204, 0.07763719824213175, 0.07984428713062765, 0.0664021851728117, 0.06613581422016714, 0.12447369235784002, 0.1073701355295224, 0.09725351661215852, 0.11146611392359543, 0.10513113581091144],
1: [0.08142740703996627, 0.0925100494190626, 0.09129700167437743, 0.0817453525384093, 0.07044412842839191, 0.12499352978884987, 0.10565852044546856, 0.11561868221783557, -0.024600329648532815, 0.10506436385415222, 0.07114852665093951, 0.042451470064612216, 0.06996610041753384, 0.08171100680501381, 0.08081793917923678, 0.0758378043870103, 0.0674786833382237, 0.07342694868905968, 0.0769671203323385, 0.06265991151994707, 0.09860677951955465, 0.10045475267375198, 0.07906866916508141, 0.10012642557860424, 0.0921991108841761],
2: [0.05228332255319131, 0.09268445629134116, 0.057769993055200114, 0.04207756834864787, 0.05258838051668914, 0.12496103858659593, -0.005327083289752201, 0.11608779300032918, 0.0, 0.11142460204945098, 0.08495560103787653, 0.022125604697837146, 0.0725226447403611, 0.038272958474878625, 0.0835300396831607, 0.0660569814071326, 0.05640650922657711, 0.05744784334102391, 0.06222741690918363, 0.058686913668575376, 0.07287202861695966, 0.06831768910813804, 0.0507719400882762, 0.08932376418137633, 0.10625549670507668],
3: [0.028035325451666027, 0.0700607817943006, 0.0333526258779912, -0.044581666674650945, -0.006131591366276377, 0.10528405911757263, 0.13785818088906512, 0.05087467330667287, 0.07222456184381904, -0.03344758343884219, 0.07685381755220104, 0.08132380439338263, 0.05357705010072535, 0.09734635899002664, 0.087435887480547, 0.003791025259487916, 0.04675040593655057, -0.019216948586341175, 0.06649996179960667, 0.05714308055184366, 0.06279482641869338, -0.004229223802735906, -0.04542231186257633, 0.07857273320749884, 0.06952069465187896],
4: [0.042133992359530754, 0.023714428807102013, 0.004334268063792843, 0.033067731201797713, 0.037223370098473305, 0.08568552328541766, 0.10757427968171995, 0.10045189484454395, 0.10915759379720388, 0.04136442190021024, 0.07441866882454426, 0.058453870926103074, 0.0, 0.09460001078177731, 0.0046194139636116585, 0.07342254224130389, 0.006825159492297191, 0.060264156593911274, -0.027287242386291335, 0.0525363719053861, 0.0, -0.03764140752661526, 0.10218008430861052, 0.09392231198342693, 0.06297655482197895],
5: [0.07062833223418487, 0.07491458914267692, 0.10257219845327353, 0.0864029911724437, 0.08052425812498165, 0.1069350822430478, 0.10245169048704142, 0.12643507441151802, 0.10832687350668699, 0.10434183011959151, 0.08381809256238651, 0.07862157601080767, 0.07458730715156892, 0.07594695253886016, 0.07213287940631766, 0.10098341396339074, 0.06374774140990053, 0.06513383961112322, 0.056781709585176976, 0.05600802541406846, 0.10379099519451351, 0.0927812103599037, 0.09218384526466583, 0.11277265795286995, 0.09021451984667253],
6: [0.06756035591176579, 0.07122078578138404, 0.07344151402241367, 0.08927247551493028, 0.06697431450754236, 0.11567768224243324, 0.10584117936980758, 0.11545449137659347, 0.1566200876281998, 0.1035798806904806, 0.07803010620172081, 0.07579404532516931, 0.0828336330012875, 0.06602517257640123, 0.07758342223584991, 0.05548030470405619, 0.06852666751099633, 0.06382519379905359, 0.05025252195870455, 0.046809886801521476, 0.08896298003743215, 0.0862695650353462, 0.09532945450150006, 0.09827449845200259, 0.0839997235830345],
7: [0.06195148549866437, 0.07445473603860242, 0.07426227576947247, 0.07449849834969412, 0.04666432603246595, 0.08276382441241716, -0.04607671529814337, 0.10242599197850637, 0.06462421154584334, 0.12129689786660207, 0.0784026037041984, 0.05601761033941207, 0.0817205877787005, 0.06378426816330116, 0.04560594630579132, 0.036392896856571225, 0.02607944806250389, 0.06359672956048287, 0.05784115965923515, 0.05665893499869418, 0.06660789724089991, 0.07025180198567019, 0.08331551536667751, 0.08868818636882302, 0.09213460262171323],
8: [0.0, 0.039668566352657725, 0.09166566247032679, 0.06749358422062923, 0.06807872180475279, 0.0792297039922755, 0.10182828299561977, 0.1013125607882426, 0.09005884458353437, 0.13979261308291444, 0.07272388959015234, 0.07121871004365474, 0.07430761539355178, 0.07072065219650117, 0.0722226934935954, 0.055365179691014205, 0.05843130721350337, 0.032082203183356514, 0.0176646616357657, -0.002784341032220035, 0.08330263198060818, 0.09445838520178096, 0.05875666984646937, 0.08524087374085144, 0.09245607958875464],
9: [0.038614923667437406, -0.03632007169018548, 0.03977976740453096, 0.03637106605137025, 0.0763109803788343, 0.06222613196294462, -0.11979514915218616, 0.09517156606528376, 0.12965404206790362, 0.08264038130627786, 0.10555537177480263, 0.06856241749472775, 0.05886645379770113, 0.08786950828341508, 0.08093642264014846, 0.04635622431067375, 0.07790694178104485, 0.034991582017255725, 0.06474527650306344, 0.005979753079226905, 0.08932394558077612, 0.03897693472752776, 0.03815177904286754, 0.08288012256534974, 0.07226079341280212],
10: [0.0946683213843703, 0.10498654751290513, 0.09485262915342468, 0.10098032124818497, 0.0892507059038274, 0.12127404371818824, 0.15246634155480368, 0.10228952931267184, 0.1254611960431521, 0.15724539389566855, 0.08985275587043141, 0.0842922733792755, 0.07987517680368351, 0.11148296681745286, 0.10460086854647155, 0.09401325859250963, 0.07339061730246212, 0.0937528668738551, 0.0948405138990268, 0.07181041460646656, 0.08681290626732727, 0.0934402619882318, 0.10762261770890347, 0.10604866540427992, 0.11029954574556035],
11: [0.08440457089712736, 0.09421951944316458, 0.09083426004194188, 0.08646158570246436, 0.09028761561507646, 0.11299738537489847, 0.11953496803726354, 0.11764582142059657, 0.12955463002488932, 0.11881195708516196, 0.09669130515542859, 0.09669130515542859, 0.08970690383178123, 0.08410409852608075, 0.06881510346319024, 0.05717163122864876, 0.07014462323137917, 0.05193102511179159, 0.06591375965399805, 0.06550248690217886, 0.10413778808449178, 0.10012642557860424, 0.09690406831246949, 0.10126077378388232, 0.10283198933261013],
12: [0.0960264285437633, 0.10502612923084381, 0.07563851129436452, 0.07995087661225539, 0.09195311380482953, 0.1558940185375278, 0.15053450191435075, 0.1389123919318481, 0.15999911325947622, 0.1115954211405685, 0.08215999747867098, 0.10070198002539645, 0.10851350495535195, 0.07810396190022405, 0.0713305807508931, 0.07124516641912396, 0.08314548241744257, 0.0666386898516343, 0.06710878735080628, 0.07541353511971594, 0.11021650952659019, 0.12109110407357997, 0.11182698674002542, 0.11565898213362419, 0.11692863475431987]
}



 sortierbar nach validation splits mit:


tstdict = {0:[],1:[],2:[],3:[],4:[]}
for id, entry in enumerate(cv_val_results):
    place = tstdict[id % 5]
    place.append(entry)
    tstdict[id % 5] = place

eliminate low mccs:

no_low_dict = {}
for key in hyperparameter_dict.keys():
    value = hyperparameter_dict[key]
    mcc_arra = []
    for val in value:
        if val > 0.03:
            mcc_arra.append(val)
    no_low_dict[key] = mcc_arra

total_run_layers = [
[128,64,32],
[64,32,16],
[32,16,8],
[16,8],
 [8],
 [64,64,32,32],
[32,32,16,16],
[16,16,8,8],
 [64,16,32,16,32,8],
[16,8,16,8,16,8],
 [256,128,64,32],
[512,32],
[512,256,128,64,32]
]


with best val mcc:

[[2048,1024,512,256,128,64,32],[1024,512,256,128,64,32],[512,256,128,64,32],[128,64,32],[64,32,16],[32,16,8],[16,8],[8]]
{
 0: [0.11144751229517635, 0.11645316187761234, 0.1302557998421494, 0.1500090967350607, 0.08401718522891322, 0.09494968143771021, 0.09859338507462978, 0.09243117140680324, 0.11309023406437735, 0.1215776661897181],
 1: [0.12138788761174324, 0.11589502929626594, 0.1764272807009708, 0.1619667835887023, 0.10555196928626087, 0.1114429743228893, 0.08837284810135804, 0.06432309409219295, 0.11421929760086902, 0.12622325205111085],
 2: [0.10810622067468256, 0.10850181226992539, 0.15467280426378327, 0.16136495453051924, 0.10250699396539675, 0.07931726369377845, 0.09921816072090683, 0.09409529396165661, 0.11893261920569398, 0.13326485779082775],
 3: [0.09460519540003087, 0.09863753201588055, 0.11143383216850566, 0.13101466687336627, 0.09350252815396298, 0.11483919868901138, 0.07781398943192053, 0.09801272651600967, 0.10547984205648975, 0.10765358191031427],
 4: [0.08492567422394037, 0.11676524436380675, 0.12203759811661608, 0.1168217827231669, 0.08359097500882884, 0.09424822503567587, 0.0801114600265902, 0.07607934388327375, 0.10292498576604814, -0.002990070020734814],
 5: [0.08917272626994421, 0.06335605933105293, 0.2608098835641647, 0.12173511853551999, 0.0541503947519294, 0.11319494777119432, 0.06227227453246975, 0.06295133390077834, 0.09721835879387153, 0.11771739987581686],
 6: [0.09244686068901864, 0.05186796793874393, 0.17096832522370753, 0.1110842087051872, 0.06321123722485655, 0.11884114097040965, 0.0643045462642321, 0.004319029729052404, 0.10015487709384019, 0.09953666133298422],
 7: [-0.023968757432188514, 0.0, 0.10892937596429453, 0.0, 0.07190803945067747, 0.0, 0.028554258432250346, 0.03997891055591363, -0.002990070020734814, 0.0960903403945762]
 }

[512,256,128,64,32] chosen because highest mean mcc

analysis of hops:
[[1,1,1,1,1,1],[2,1,1,1,1,1],[2,2,1,1,1,1],[3,2,1,1,1,1]]

{
0: [0.10810622067468256, 0.10850181226992539, 0.15467280426378327, 0.16136495453051924, 0.10250699396539675, 0.07931726369377845, 0.09921816072090683, 0.09409529396165661, 0.11893261920569398, 0.13326485779082775],
1: [0.10967269410965774, 0.08465305520234812, 0.15999911325947624, 0.1622293038211824, 0.10181335442880846, 0.14604552332699994, 0.10239417412184404, 0.10401969621312734, 0.12744857488300765, 0.11009711576691306],
2: [0.0886501803394878, 0.08476168987222388, 0.11965990886093447, 0.14161440004944525, 0.09371836572038372, 0.0854039655563874, 0.06955781924255056, 0.08454610746132463, 0.09761238842504993, 0.10229474765549351]
}

[2,1,1,1,1,1] hops list provides best mean mcc

previously normalization only before output layer
1: [0.10967269410965774, 0.08465305520234812, 0.15999911325947624, 0.1622293038211824, 0.10181335442880846, 0.14604552332699994, 0.10239417412184404, 0.10401969621312734, 0.12744857488300765, 0.11009711576691306],

normalizationon all:
0: [0.09426623490373709, 0.09646398485957808, 0.11898101745847078, 0.1706248098418648, 0.08838662823508214, 0.11195353688677656, 0.0768847524942009, 0.08521736842028627, 0.1157563081677373, 0.1261278872982199],

on none:
2: [0.0, 0.09801003980314371, 0.005309243021428434, 0.12177946051895916, 0.0, 0.0, 0.0, 0.0, 0.005327083289752177, 0.0, 0.0, 0.0, 0.0, 0.032838848074413174, 0.0, 0.0, 0.06799282679738494, 0.0, 0.0, 0.0, 0.0, 0.09216945958029532, 0.0, 0.0, 0.007329573954532043]

after first, before last:
0: [0.10345850412254354, 0.06307371206692347, 0.10424010642846704, 0.11100670642066035, 0.10887335193816783, 0.16424704841672677, 0.1528185530150714, 0.12192028360249774, 0.15371572025722613, 0.17058048301559936, 0.11623510857430697, 0.1085424417617672, 0.11057120180984803, 0.11874368444460726, 0.08213126598527676, 0.06891003289809217, 0.07739644648236066, 0.06726523061829903, 0.08515558303712589, 0.08789502689973971, 0.12579706628138565, 0.11885053037449556, 0.13726716061661248, 0.1354467694812529, 0.09936271083738424]

{
"normalization none": [0.0, 0.09801003980314371, 0.005309243021428434, 0.12177946051895916, 0.0, 0.0, 0.0, 0.0, 0.005327083289752177, 0.0, 0.0, 0.0, 0.0, 0.032838848074413174, 0.0, 0.0, 0.06799282679738494, 0.0, 0.0, 0.0, 0.0, 0.09216945958029532, 0.0, 0.0, 0.007329573954532043],
"before last": [0.10967269410965774, 0.08465305520234812, 0.15999911325947624, 0.1622293038211824, 0.10181335442880846, 0.14604552332699994, 0.10239417412184404, 0.10401969621312734, 0.12744857488300765, 0.11009711576691306],
"after first\nbefore last": [0.10345850412254354, 0.06307371206692347, 0.10424010642846704, 0.11100670642066035, 0.10887335193816783, 0.16424704841672677, 0.1528185530150714, 0.12192028360249774, 0.15371572025722613, 0.17058048301559936, 0.11623510857430697, 0.1085424417617672, 0.11057120180984803, 0.11874368444460726, 0.08213126598527676, 0.06891003289809217, 0.07739644648236066, 0.06726523061829903, 0.08515558303712589, 0.08789502689973971, 0.12579706628138565, 0.11885053037449556, 0.13726716061661248, 0.1354467694812529, 0.09936271083738424],
"all": [0.09426623490373709, 0.09646398485957808, 0.11898101745847078, 0.1706248098418648, 0.08838662823508214, 0.11195353688677656, 0.0768847524942009, 0.08521736842028627, 0.1157563081677373, 0.1261278872982199]
}


# wtf is this from {0: [0.24998547812003102, 0.25186262501392864, 0.24640418409426657, 0.2354818545879661, 0.24167465948159483, 0.24416823055464365, 0.25185676553096625, 0.24923907858707595, 0.2974913846751268, 0.3014924428227641, 0.2390108398206261, 0.23290369361992802, 0.219906954222861, 0.2357620298202192, 0.23461809860976668, 0.25631046522619616, 0.24220871355834417, 0.23264330054324922, 0.25662586733880977, 0.24737584741471008, 0.26373191208029834, 0.26612746534873755, 0.3153445635610129, 0.26464473300703517, 0.28064131124059366]}



bert layer eval:
layer_sizes = [[512],[16,8,8,8],[16,8,8],[16,8],[8]]
{0: [0.3153822874796768, 0.28097603402320614, 0.34161763678900336, 0.24901827450161862, 0.2299653115226845, 0.34500253118883184, 0.29505600803157317, 0.28386018671724755, 0.37468203941069933, 0.2966240913922157], 1: [0.22037509275541023, 0.2046824556874407, 0.23773224117302383, 0.18112187701706828, 0.23015648172321346, 0.203579171524381, 0.25497578086206274, 0.16686355331696134, 0.35189925787951326, 0.2148482702417761], 2: [0.25935579705344736, 0.19969555509220882, 0.23122261674685307, 0.24944868658664465, 0.2185528843151857, 0.1951842982138675, 0.21473424694905574, 0.21092939594096993, 0.27031519981309704, 0.30584776855904083], 3: [0.2545423326913483, 0.22077435126760558, 0.22934538266668103, 0.2579626108479163, 0.23805861697931696, 0.2045730601645166, 0.2407509729650048, 0.14548185233194721, 0.23919993361447034, 0.2504783521284669], 4: [0.2878345916130499, 0.2805550551906201, 0.38459390183843734, 0.2735348490945769, 0.24172155297314868, 0.24629293026740795, 0.220657602802531, 0.2164952675990076, 0.17622128863422704, 0.29903670779208236]}

distance map with 10 amstrong layout: 1024, 512 on glove
[0.12839840930476354, 0.11358427758915757, 0.1529589970988081, 0.14265326662994726, 0.1222706553845736, 0.15281848593322633, 0.1591713929672971, 0.15203880045098728, 0.18122570924136006, 0.17989552708712986]

distance map with 6 amstrong layout: 1024, 512 on glove
[0.23681818934973153, 0.09663957341992857, 0.35734087203743903, 0.342808620784848, 0.2977812972716358, 0.3720439470435698, 0.19984452074836867, 0.16746038209659153, 0.35205082542648825, 0.35809402862357986]
layout: 1024
[0.32793731852314134, 0.3075372460595506, 0.4203991284197419, 0.3896443236359126, 0.4112296518729903, 0.4205841755584476, 0.22565229224169825, 0.32752031469054277, 0.39950421773070843, 0.4162241957614913]

contact map with 6 amstrong layout: 1024, 512 on glove
[0.11102539464039796, 0.20356183271591832, 0.3969172534518888, 0.2904931889529515, 0.23694350262199226, 0.31209615139971647, 0.17925063515965345, 0.19765088224276672, 0.3634919906214338, 0.3047046377128374]
layout: 1024
[0.2676630760806662, 0.320398882944785, 0.436979026640258, 0.40104806019507244, 0.39682593858409865, 0.4067481671473121, 0.31889551627276336, 0.3376568826026206, 0.4350321279080518, 0.3822196628372754]


contact map with 6 amstrong layout: 1024 on Bert
[0.2986756835721299, 0.27429085986615354, 0.31937894157837676, 0.24528788702194804, 0.2762183540088421, 0.3177785806308129, 0.30002383855688697, 0.3098547852153589, 0.29622219429807495, 0.290834272117682]
layout: 1024, 512
[0.2623016749064724, 0.30373617887974125, 0.34297891298447625, 0.35082161808732537, 0.33047235617773074, 0.2705067329818349, 0.27382705541271535, 0.2955149890875646, 0.2711833246224309, 0.2514142898152609]


random baseline
[0.08733744194944082, 0.06944029558203453, 0.03370194462421426, 0.12147104966864684, 0.060886709447912184, 0.0005608395334355112, 0.07015680149558953, 0.011027561100601635, 0.0912321010840418, 0.0623608912102032, 0.09001542572207222, 0.10569887693724563, 0.09201762182179823, 0.1292164251457661, 0.10641112599957808, 0.07103081078316777, 0.060296327526575245, 0.07282782978855211, 0.07661040174036646, 0.12047661239861851]
